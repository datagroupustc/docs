## 功能需求描述

### 说明
功能需求分为以下部分：
- **普通用户需求**：即不需要与其他功能模块对接，只需要进行数据库操作和前端开发的功能。主要工作量在于页面的设计和开发，主要集中在UI的美观和亲切度。
- **系统功能需求**：需要与其他模块对接，调用函数以实现相应请求
- **系统维护需求**：即后期维护系统的相关需求，应在开发过程中设计并保留接口，以方便后期功能的新增与更改，相关设置的更改等操作。
- **系统性能和安全需求**：关于系统安全和服务的相关需求，包括不仅限于数据库安全，抵御DOS攻击等。关于系统性能的需求：例如拥塞、IO性能等
- **系统审计需求**：提供界面允许超级用户——系统管理员进行信息的查看

其中 **普通用户需求** 和 **系统功能需求** 按照以下格式进行编辑：
- **功能**：说明需求内容
- **附加需求**：实现该功能的注意事项，步骤，应有的机制
- **前置条件**：
- **系统后置行为**：完成该功能后数据库、用户状态、系统应做的变化
- **异常处理机制**：该功能实践中可能遇到的异常情况以及异常处理机制
- **扩展点**：

**系统维护需求** 、**系统性能和安全需求** 和 **系统审计需求** 按照以下格式编辑：
- **需求描述**：简要说明需求内容，或应该具有的性能，应展示的信息
- **测试样例**：为检验该需求被满足的测试样例，可以进行描述，例如性能要求支持万人量级用户同时访问，则测试样例应为模拟万人访问行为。

<div class="page-break"></div>

### 普通用户需求

#### 注册
- **功能**：新用户注册平台，允许通过邮箱、手机号两种方式注册平台，并设置用户名，密码。
- **附加需求**：
   - 邮箱注册应使用链接确认方法，手机注册应使用短信验证码，并限制链接与验证码的有效时间。
   - 密码不允许出现特殊字符，限制使用 大小写字母，数字，标点符号。
   - 防御DOS攻击的措施：例如1分钟内不可重复发送短信验证码、IP访问限制等。
   - 前端实时正则匹配用户输入的邮箱、手机号、密码的合法性，并显示相应的提示。
   - 后端在得到注册信息后，先进行查重，不允许相同邮箱、手机号、用户名的出现。
- **前置条件**：无
- **系统后置行为**：
   - 更新用户数据库列表，记录注册时间等相关信息
   - 跳转页面至主页，并将状态置为登录状态，更新用户session信息使浏览器记住密码。
- **异常处理机制**：
   - 错误的邮箱、用户名、手机号格式
   - 错误的验证码
   - 验证码、验证链接过期
   - 重复注册的邮箱、手机号、用户名
   - 同一IP短时间内的大量注册请求
- **扩展点**：无

#### 登录
- **功能**：用户登录网站
- **附加需求**：
   - 用户名、密码等的合法性检验
   - 未注册用户名（邮箱，手机号）：提示用户跳转注册页面
   - 多次尝试未正确登录：提示用户找回密码
   - 自动登录功能：在一定时间范围内如果用户已登录过平台，则再次打开平台时直接将状态置为已登录。
- **前置条件**：无
- **系统后置行为**：
   - 更新数据库中的登录时间，更新session
   - 跳转页面至主页，并将状态置为登录状态
- **异常处理机制**：
   - 错误的账号密码
- **扩展点**：
   - 找回密码

#### 找回密码
- **功能**：用户忘记密码后重新设置密码
- **附加需求**：
   - 为验证用户身份，应类似注册行为通过邮箱、手机号进行验证
   - 新密码的双重确认和正则匹配
- **前置条件**：无
- **系统后置行为**：
   - 更新数据库中的用户密码，清除session中相关信息
   - 跳转页面至登录界面
- **异常处理机制**：
   - 未注册的账号
- **扩展点**：无

#### 修改个人信息
- **功能**：
   - 用户修改个人信息，信息包括 邮箱、联系电话（二者注册一个，可完善一个）、性别、出生日期、国家地区、学历、职业、支付卡、照片。
   - 视开发进程考虑实现 个人实名认证和企业认证
- **附加需求**：
   - 完善个人信息时应先检测登录状态，在根据session登录的情况下，应退回登录界面让用户重新登录
   - 用户照片的上传、存储、安全检验。限制照片大小
   - 其他信息的正则匹配，性别、国家、出生日期、学历、职业以选择框的形式显示
- **前置条件**：用户登录平台
- **系统后置行为**：
   - 更新数据库中相关信息
   - 刷新页面，将用户填写的信息进行展示
- **异常处理机制**：
   - 超过大小限制的照片上传
- **扩展点**：无

#### 系统通知
- **功能**：
   - 推送系统通知，用户可以在登录后的主页和个人信息页面查看
   - 分类为：交易通知，API使用完成通知，API结果到期提醒，系统调整通知，数据集信息待完善，数据集安全检测失败，数据集评估完成 <font color=red>待补充</font>
   - 检测过期的通知，并进行删除处理
- **附加需求**：
   - 提供过滤条件：时间、类型
   - 消息状态：已读、未读。允许用户设置消息已读or未读
   - 显示应清晰明确
   - 消息应提供详情的链接：交易通知能够转到`交易记录`和`交易详情`页面；API使用完成可以转到`API使用记录`页面；API结果到期提醒可以转到`API使用记录`页面；系统调整通知则只需展示更新内容即可；数据集信息待完善或数据集安全检测失败可以转到`数据集详情`页面；数据集评估完成信息可以转到`配置数据集售卖信息`。
- **前置条件**：用户登录平台
- **系统后置行为**：
   - 更新消息的状态
- **异常处理机制**：无
- **扩展点**：无

#### 展示交易记录
- **功能**：
   - 用户查询自己的充值记录、买卖记录
   - 信息应显示：时间、交易内容、描述、交易金额，对于数据集的购买和API的使用，应分别提供数据集详情页面、下载链接和API结果下载链接。 <font color=red>需要补充细节</font>
- **附加需求**：
   - 提供过滤条件：交易类型，商品类型
   - 显示应清晰明确
   - 用户可以从交易记录中直接跳转到商品详情页面
- **前置条件**：用户登录平台
- **系统后置行为**：无
- **异常处理机制**：无
- **扩展点**：用户查看交易详情信息后返回

#### 展示用户资产资产
- **功能**：
   - 用户查询自己拥有的资产，分别包括：拥有（拥有权、使用权、共享）的数据集和API的使用次数
   - 信息应显示：时间、资产类型、资产名称、描述、获取方式（购买的需要写明价格），数据集/API详情页面的链接、修改（有拥有权的）数据集描述的页面链接，配置（有拥有权的）数据集的售卖信息。API充值的跳转链接。
- **附加需求**：
   - 提供过滤条件：商品类型、获取方式、获取时间
   - 显示应清晰明确
   - 用户可以从资产条目中根据提供的链接进行跳转
- **前置条件**：用户登录平台
- **系统后置行为**：无
- **异常处理机制**：无
- **扩展点**：用户跳转到其他页面后返回

#### 查询API使用记录
- **功能**：
   - 用户查询自己的API使用记录
   - 用户可通过查询下载使用结果
   - 信息应包括：使用时间、数据集ID、运行状态、结果文件链接、运行参数配置、训练精度、识别结果准确度等信息 <font color=red>需要补充细节</font>
- **附加需求**：
   - 提供过滤条件：时间、API类型、运行状态，提供根据API ID和数据集ID的直接过滤手段
   - 显示时，根据不同类型的API应允许显示不同的附加项
   - API运行结果文件下载——参照`下载API使用结果`
- **前置条件**：用户登录平台
- **系统后置行为**：无
- **异常处理机制**：无
- **扩展点**：用户查看交易详情信息后返回

#### 下载API使用结果
- **功能**：
   - 下载API使用的结果文件
- **附加需求**：
   - 如果结果文件已被清理，则不会提供下载链接，即在API使用记录中不提供链接
   - 下载数据前需要进行身份认证，或者下载的数据要有密码加密
   - 断点续传
- **前置条件**：用户登录平台，数据集是用户所持有的
- **系统后置行为**：无
- **异常处理机制**：无
- **扩展点**：无


#### 上传数据集
- **功能**：
   - 用户上传数据集
- **附加需求**：
   - 断点续传，大文件上传
   - 上传成功后，需要用户设置数据集名称、数据集类型、数据集描述、数据集功能描述以及是否在平台上出售等选项（这几项均需符合规范），全部填写完毕后则上传成功。
   - 用户只上传了文件，但并未配置其他信息时，将文件进行隔离（此时不需要进行安全检测），并一定时间内没有填写相关信息时，进行删除。
   - 用户未完善信息时，应发送提醒用户完善信息的`系统消息`。
- **前置条件**：用户登录平台
- **系统后置行为**：
   - 用户完善信息后调用文件安全检测模块，检测文件安全
   - 文件安全时进行数据库和存储的相应操作，改变数据集组织形式并进行规范化存储；若文件不安全，则进行隔离，并发送`系统消息`提醒用户-数据集安全检测失败。
   - 在用户确认此数据集是将要售卖之后，调用`质量评估`，`功能评估`，并在评估结束后发送`系统通知`，通知用户进行售卖配置。
- **异常处理机制**：
   - 文件过大
   - 断点续传
- **扩展点**：无

#### 下载数据集
- **功能**：
   - 用户下载有拥有权的数据集
- **附加需求**：
   - 断点续传，大文件下载
   - 一个下载链接只允许用户下载一次，从而避免其他未授权的用户下载数据，或通过下载链接绕过平台进行交易（或采用其他保护措施）。
- **前置条件**：用户登录平台，用户拥有此数据集
- **系统后置行为**：无
- **异常处理机制**：
   - 文件过大
   - 断点续传
- **扩展点**：无

#### 修改数据集描述信息
- **功能**：
   - 用户可以在数据集详情页面中完善或修改自己上传、有拥有权的数据集的信息
- **附加需求**：
   - 此处指的数据集详情页面和用户搜索查看的页面不同，此页面中的信息只允许数据集拥有者进行查看和修改。
   - 可修改的项包括：数据集名称、描述、类型、功能描述。提供的链接为重新配置数据集售卖信息（上述描述和配置在数据集产生盈利后不允许再次修改）。
   - 若质量评估和功能评估完成，在此页面向用户展示评估结果（图表和文字说明）。
- **前置条件**：用户登录平台，用户拥有此数据集
- **系统后置行为**：
   - 更新数据库对应表项
- **异常处理机制**：
   - 用户提交的信息异常，例如名称不符合规范等
- **扩展点**：无

#### 删除拥有的数据集
- **功能**：
   - 用户可以删除自己拥有的数据集
- **附加需求**：
   - 重复确认，条款同意。
   - 用户可在资产页面选择`删除数据集`，则平台修改相关的数据库信息，如果平台上其他用户没有访问此数据集的权限，则将数据集文件也进行删除
- **前置条件**：用户登录平台，用户拥有此数据集
- **系统后置行为**：
   - 更新数据库对应表项，清除相应文件
- **异常处理机制**：无
- **扩展点**：无



### 系统功能需求


#### 关键字搜索数据集
- **功能**：
   - 用户输入关键字搜索数据集
- **附加需求**：
   - 用户可以设置过滤选项（包括：数据集模态、数据集大小、数据集包含数据元个数、数据集发布日期、数据集卖家机构）和排序方式（包括：综合排序（默认），数据集发布日期，数据集价格，数据集大小，数据集包含数据元数目）。
   - 任务调度，反应时间
   - 缓存机制，同样的查询直接返回结果而不需调用查询模块
   - IP限制，防范攻击
- **前置条件**：无
- **系统后置行为**：
   - 更新数据库中记录用户搜索记录的表项
- **异常处理机制**：无
- **扩展点**：无

#### 目录检索数据集
- **功能**：
   - 用户目录检索数据集
- **附加需求**：
   - 通过树形分类目录搜索数据集，UI具体操作为：鼠标滑动到一个类别上时，如果存在子类别，则自动展开子类别；然后用户可以点击任一层次的类别名称，e.g. 可以点击“图片数据”，也可以点击该类别下的子类别“动物”，也可以点击动物类别下的“狗”，大概是这样一个层次化的目录检索需求。
   - 用户可选择限制项和排序方法（同关键字搜索）
- **前置条件**：无
- **系统后置行为**：
   - 更新数据库中记录用户搜索记录的表项
- **异常处理机制**：无
- **扩展点**：无

#### 显示数据集搜索结果
- **功能**：
   - 显示数据集搜索的结果
- **附加需求**：
   - 展示的信息：数据集缩略图、数据集名称、类型、描述、评估结果、售卖信息（例如价格）
   - 用户点击数据集信息则进入数据集的详情页面
- **前置条件**：用户通过关键字或者目录检索数据集
- **系统后置行为**：
   - 更新数据库中记录用户搜索记录的表项
- **异常处理机制**：无
- **扩展点**：无

#### 显示数据集详细信息
- **功能**：
   - 显示一个数据集的详细信息
- **附加需求**：
   - 数据集的名称、类型、描述信息、售卖信息、功能评估、质量评估、隐私脱敏方式、隐私评估、价格（拍卖方式）、已售出份数、限售份数、和数据示例等
   - 提供购买数据集的接口（定价购买/参与拍卖）
   - 拍卖的数据集：设置“想要”项，供用户提前表露是否参与拍卖的意向，并在拍卖正式开始前向用户发送`系统消息`提醒。
- **前置条件**：无
- **系统后置行为**：
   - 更新数据库中记录用户搜索记录的表项
- **异常处理机制**：无
- **扩展点**：无

#### 以发布价格定价购买数据集和API
- **功能**：
   - api购买页面
      - 用户点击购买后，弹出相关提示信息，等待用户确认
      - 用户确认购买后，弹出选择付款方式（例如支付宝、银联卡等），等待用户付款，购买模块不在此赘述。
      - 用户完成付款后，跳转回api详情页面，并更新页面显示的“剩余调用次数”。
   - 数据集购买页面
      - 用户点击购买，完成购买后，返回数据集详情页面。
- **附加需求**：
   - 同一用户不允许购买同一数据集多次
   - 安全需求：用户购买行为完成后，才更新相应信息
- **前置条件**：无
- **系统后置行为**：
   - 更新数据库中相应表项，更新用户权限
- **异常处理机制**：
   - 用户付款失败
   - 用户尝试购买已拥有的数据集
- **扩展点**：无


#### 拍卖数据集
- **功能**：
  - 根据用户指定的不同拍卖模式设定拍卖算法
  - 在用户指定时间给出winner和price(offline)或serve and leave(online)
- **附加需求**：
  - 由卖家指定买家能否多次出价，系统更新数据库
- **前置条件**：
  - 新建拍卖的信息存到数据库，明确用户权限
- **系统后置行为**：
  - 拍卖完成后更新数据库中的交易信息
- **异常处理机制**：
  - 没有正常卖出
- **扩展点**：无


#### 分类检索API
- **功能**：
   - 用户目录检索API
- **附加需求**：
   - 由于API数量不多，直接按照分类展示所有数据集
   - 展示API缩略图、名称、类型、价格、描述信息等
- **前置条件**：无
- **系统后置行为**：无
- **异常处理机制**：无
- **扩展点**：无

#### 显示API详情信息
- **功能**：
   - 显示一个API的详细信息
- **附加需求**：
   - API的名称、类型、描述信息、拥有的使用次数（用户登录后）、使用说明、状态码、使用实例、参数说明
   - 提供购买API使用次数的接口
   - 提供使用API的接口（跳转/切换页面）
   - 提供购买数据集的接口（定价购买/参与拍卖）
- **前置条件**：无
- **系统后置行为**：无
- **异常处理机制**：无
- **扩展点**：无

#### 调用API
- **功能**：
   - 用户配置参数调用系统提供的API
- **附加需求**：
   - 用户权限认证
   - 配置信息时，页面中应动态显示用户配置参数的含义与推荐值
   - 参数的正则匹配，合法检验
   - API运行过程中，需要相应的图表展示运行过程
- **前置条件**：用户登录平台，并且用户拥有该API的使用次数大于0，所选数据集是有访问权限的
- **系统后置行为**：
   - 更新数据库中用户API的使用记录、剩余次数、结果存放路径等信息
   - API调用结束后，通过系统消息通知用户
- **异常处理机制**：
   - API运行异常或失败
- **扩展点**：无



#### 实时展示api运行过程

- **功能**：在api运行过程中，与api实时通信，并在页面展示运行过程中各项指标的变化
- **附加需求**：
  - 有良好的图形化展示效果
- **前置条件**：前端准备好接收数据和作图
- **系统后置行为**：无
- **异常处理机制**：捕捉异常，返回状态码，并在数据库中记录
- **扩展点**：无

#### 实时展示api审计安全状态

- **功能**：在数据库查询，并在监控页面实时展示API安全状态；当安全状态发生变化时实时更新。
- **附加需求**：
  - 有良好的图形化展示效果
- **前置条件**：无
- **系统后置行为**：无
- **异常处理机制**：捕捉异常，记录日志
- **扩展点**：无

#### 实时展示数据集审计安全状态

- **功能**：在数据库查询，并在监控页面实时展示数据集安全状态；当安全状态发生变化时实时更新。
- **附加需求**：
  - 有良好的图形化展示效果
- **前置条件**：无
- **系统后置行为**：无
- **异常处理机制**：捕捉异常，记录日志
- **扩展点**：无

#### 数据相似程度检查

- **功能**：
   - 新上传数据集后进行相似程度检查和报告
- **前置条件**：用户上传数据集，数据集信息被成功记录在数据库和文件系统里
- **系统后置行为**：
   - 如果判定为新数据，更新数据库内对应数据的哈希值
   - 如果判定为重复数据，返回给用户和管理员相似程度的检查报告
- **异常处理机制**：
   - 某些函数出现异常，对应会返回不同的错误代码。

#### 配置数据集贩卖信息

- **功能**：
  - 每笔交易状态有所改变时同步修改数据库内容
- **前置条件**：每笔新开的交易都将信息存储到数据库相应表格里
- **系统后置行为**：
  - 定价或拍卖完成后在对应函数里更新数据库
  - 同步更新相关联的table的信息
- **异常处理机制**：
  - 拍卖或定价出现异常，对应会返回不同的错误代码。


#### 配置数据集脱敏

- **功能**：用户配置数据集脱敏信息
- **附加需求**：不同数据类型有不同的脱敏配置
- **前置条件**：
  * 数据集在数据库中完整存在
  * 图片数据已完成数据理解
- **系统后置行为**：
  * 保存脱敏后数据到数据库
  * 保存脱敏配置到数据库
- **异常处理机制**：
  - 图片数据理解结果不存在
- **扩展点**：无
#### 显示数据集脱敏结果

- **功能**：显示数据脱敏的结果
- **附加需求**：不同数据类型有不同的显示方式和页面
- **前置条件**：
  * 数据已完成脱敏
- **系统后置行为**：无
- **异常处理机制**：
  * 数据脱敏未完成
- **扩展点**：无

### 系统维护需求

#### api运行结果的清理

- **需求描述**：检查调用结果的剩余保存时间，通知用户并清理文件。
- **附加需求**：减少运行开销。
- **前置条件**：
- **系统后置行为**：文件系统中，存储时间超过期限的运行结果文件被清理；数据库中相应的调用记录中记录“结果已被清理”。
- **异常处理机制**：捕捉异常，记录日志
- **扩展点**：无

#### 上线api

- **需求描述**：添加新的API，并上线新api的页面
- **附加需求**：
- **前置条件**：
- **系统后置行为**：增加新API的页面；在API浏览页面或搜索页面添加新的API
- **异常处理机制**：捕捉异常，记录日志
- **扩展点**：无

#### 下架api

- **需求描述**：下架已有的API，去掉相应的页面
- **附加需求**：
- **前置条件**：
- **系统后置行为**：去掉新API的页面；在API浏览页面或搜索页面去掉当前API
- **异常处理机制**：捕捉异常，记录日志
- **扩展点**：无

#### 增删数据元模型

- **需求描述**：质量评估和功能评估的模型增删，以及增删后任务调度算法的变化

### 系统性能和安全需求

#### 文件安全需求
- **需求描述**：
   - one method:提供文件隔离区，隔离区内的文件不会威胁到系统安全
   - 用户上传的文件需要保证没有病毒、蠕虫等威胁系统安全的部分，如果检测到危险文件，需要进行隔离，删除等操作
- **测试样例**：
   - 各种数据类型的文件
   - 已知的威胁类型文件
   - 说明：如果引用其他有保证的安全检测模块，则无需进行此项测试

#### 并发需求
- **需求描述**：
   - 主要是网络流量
   - 允许大量用户访问、操作
   - 系统反应时间、用户体验

#### 任务调度与存储优化
- **需求描述**：
   - 不同功能模块应以不同的优先级得到执行
   - 任务结果缓存，避免相同任务反复执行
   - 数据库存储、并发的优化、备份

### 系统审计需求

- **用户状态审计**：用户的登录、活跃时间、网站总体用户量
- **查询与API使用审计**：用户的搜索行为，使用行为需要从用户、商品两个维度进行统计，为后续推荐系统等做准备
- **文件审计**：文件存储统计、IO频次统计
- **资源审计**：平台各项功能、模块消耗的资源、时间审计
